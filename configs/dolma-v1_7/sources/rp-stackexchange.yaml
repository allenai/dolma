streams:

  - name: stackexchange
    documents:
        - 's3://ai2-llm/pretraining-data/sources/redpajama/v1/documents/split=train/dataset=stackexchange/*.gz'
    attributes: &attributes
      - paloma_paragraphs
      - paloma_documents
    output: &output
      path: s3://ai2-llm/pretraining-data/sources/redpajama/v1_decontaminated/documents
      max_size_in_bytes: 104_857_600
    filter: &filter_docs
      exclude:
        - "$@.attributes[?(@.paloma_paragraphs && @.paloma_paragraphs[0] && @.paloma_paragraphs[0][2] >= 0)]"
        - "$@.attributes[?(@.paloma_documents && @.paloma_documents[0] && @.paloma_documents[0][2] >= 0)]"

processes: 188
